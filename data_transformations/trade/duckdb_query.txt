D SELECT
      t.reporter_id,
      t.partner_id,
      t.flow_id,
      t.cmdCode,
      t.year,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.typeCode') AS typeCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.freqCode') AS freqCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.refPeriodId') AS refPeriodId,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.refYear') AS refYear,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.refMonth') AS refMonth,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.period') AS period,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.reporterCode') AS reporterCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.reporterISO') AS reporterISO,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.reporterDesc') AS reporterDesc,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.flowCode') AS flowCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.partnerCode') AS partnerCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.partnerISO') AS partnerISO,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.partnerDesc') AS partnerDesc,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.cmdDescE') AS cmdDescE,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.cmdDescF') AS cmdDescF,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.tradeValue') AS tradeValue,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.qtyUnitCode') AS qtyUnitCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.qtyUnitDescE') AS qtyUnitDescE,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.qtyUnitDescF') AS qtyUnitDescF,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.tradeQty') AS tradeQty,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.altQtyUnitCode') AS altQtyUnitCode,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.altQtyUnitDescE') AS altQtyUnitDescE,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.altQtyUnitDescF') AS altQtyUnitDescF,
      json_extract(unnest(CAST(t.json_data AS JSON[])), '$.altQty') AS altQty
  FROM 'preview_trade_data_output.parquet/*.parquet' t
  WHERE t.json_data <> '[]';
